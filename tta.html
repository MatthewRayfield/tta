<head>
    <style>
        body {
            margin: 1 0;
        }
        .stepBox {
        }
        .step {
            width: 30px;
            height: 30px;
            display: inline-block;
            background: #cccccc;
            border-left: 1px solid white;
            border-bottom: 1px solid white;
        }
        .step.selected {
            background: #aaaaaa;
        }
        .step.current {
            opacity: .5;
        }
        #sequencerBox {
        }
    </style>
    <script>
        var cursor = 0;
        var patternA = [1,0,0,0,1];
        var patternB = [0,0,0,0,0,0,0,0,1];
        var sequencerBox;
        window.onload = function () {
            sequencerBox = document.getElementById('sequencerBox');
            render();
            //playStep();
            document.onkeydown = function (e) {
                var key = e.which;
                if (key == 65) playSound('kick.wav');
                if (key == 66) playSound('breath.wav');
                //alert(String.fromCharCode(key));
            };
        };
        function playSound(source) {
            var audioTag = document.createElement('audio');
            audioTag.src = source;
            audioTag.play();
        }
        function playStep() {
            render();
            if (patternA[cursor]) playSound('kick.wav');
            if (patternB[cursor]) playSound('breath.wav');
            cursor = (cursor + 1) % 16;
            setTimeout(playStep, (60/80)*1000);
        }
        function render() {
            var i;
            var step;
            var stepBox ;

            sequencerBox.innerHTML = '';

            stepBox = document.createElement('div');
            stepBox.className = 'stepBox';
            for (i = 0; i < 16; i ++) {
                step = document.createElement('div');
                if (patternA[i]) step.className = 'step selected';
                else step.className = 'step';
                if (i == cursor) step.className += ' current';
                (function (i) {
                    step.onmousedown = function () {
                        if (patternA[i]) patternA[i] = 0;
                        else patternA[i] = 1;
                        render();
                    }
                })(i);
                stepBox.appendChild(step);
            }
            sequencerBox.appendChild(stepBox);

            stepBox = document.createElement('div');
            stepBox.className = 'stepBox';
            for (i = 0; i < 16; i ++) {
                step = document.createElement('div');
                if (patternB[i]) step.className = 'step selected';
                else step.className = 'step';
                if (i == cursor) step.className += ' current';
                (function (i) {
                    step.onmousedown = function () {
                        if (patternB[i]) patternB[i] = 0;
                        else patternB[i] = 1;
                        render();
                    }
                })(i);
                stepBox.appendChild(step);
            }
            sequencerBox.appendChild(stepBox);
        }
    </script>
</head>
<body>
    <div id='sequencerBox'></div>
</body>
